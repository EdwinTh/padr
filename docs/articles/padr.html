<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Introduction to <code>padr</code> • padr</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to &lt;code&gt;padr&lt;/code&gt;">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">padr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.5.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/padr.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/padr_custom.html">Custom thickening and padding</a>
    </li>
    <li>
      <a href="../articles/padr_implementation.html">Implementation Information of `padr`</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/EdwinTh/padr">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Introduction to <code>padr</code>
</h1>
                        <h4 class="author">Edwn Thoen</h4>
            
            <h4 class="date">2019-08-21</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/EdwinTh/padr/blob/master/vignettes/padr.Rmd"><code>vignettes/padr.Rmd</code></a></small>
      <div class="hidden name"><code>padr.Rmd</code></div>

    </div>

    
    
<p>When getting time series data ready for analysis, you might be confronted with the following two challenges:</p>
<ul>
<li>The observations are recorded on too low a level, e.g. time recorded to the second, where your analysis is on a daily level.</li>
<li>There are no records for the time points where observations were absent.</li>
</ul>
<p><code>padr</code> aims to make light work of preparing time series data by offering the two main functions <code>thicken</code> and <code>pad</code>. A small example before we get into detail. Say I want to make a line plot of my daily expenses at the coffee place. The data for a few days might look like.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(padr)</a>
<a class="sourceLine" id="cb1-2" data-line-number="2">coffee</a></code></pre></div>
<pre><code>##            time_stamp amount
## 1 2016-07-07 09:11:21   3.14
## 2 2016-07-07 09:46:48   2.98
## 3 2016-07-09 13:25:17   4.11
## 4 2016-07-10 10:45:11   3.14</code></pre>
<p>Using <code>padr</code> in combination with <code>dplyr</code> this plot is made in the following way:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(ggplot2); <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(dplyr)</a>
<a class="sourceLine" id="cb3-2" data-line-number="2"></a>
<a class="sourceLine" id="cb3-3" data-line-number="3">coffee <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb3-4" data-line-number="4"><span class="st">  </span><span class="kw"><a href="../reference/thicken.html">thicken</a></span>(<span class="st">'day'</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb3-5" data-line-number="5"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span>(time_stamp_day) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb3-6" data-line-number="6"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span>(<span class="dt">day_amount =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(amount)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb3-7" data-line-number="7"><span class="st">  </span><span class="kw"><a href="../reference/pad.html">pad</a></span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb3-8" data-line-number="8"><span class="st">  </span><span class="kw"><a href="../reference/fill_by_value.html">fill_by_value</a></span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb3-9" data-line-number="9"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(time_stamp_day, day_amount)) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span>()</a></code></pre></div>
<p><img src="padr_files/figure-html/unnamed-chunk-2-1.png" width="672"></p>
<p>Quite some stuff going on here, let’s go through the functions one by one to see what they do.</p>
<div id="thicken" class="section level3">
<h3 class="hasAnchor">
<a href="#thicken" class="anchor"></a>thicken</h3>
<p><code>thicken</code> adds a column to a data frame that is of a higher <em>interval</em> than that of the original datetime variable. The interval in the <code>padr</code> context is the heartbeat of the data, the recurrence of the observations.<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a> The original variable “time_stamp” had the interval <em>second</em>, the added variable was of interval <em>day</em>.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1">coffee2 &lt;-<span class="st"> </span>coffee <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="../reference/thicken.html">thicken</a></span>(<span class="st">'day'</span>)</a>
<a class="sourceLine" id="cb4-2" data-line-number="2">coffee2<span class="op">$</span>time_stamp <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="../reference/get_interval.html">get_interval</a></span>()</a></code></pre></div>
<pre><code>## [1] "sec"</code></pre>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1">coffee2<span class="op">$</span>time_stamp_day <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="../reference/get_interval.html">get_interval</a></span>()</a></code></pre></div>
<pre><code>## [1] "day"</code></pre>
<p><code>thicken</code> does figure out some stuff for you. First it finds the datetime variable in your data frame (given there is only one). Next it will determine the interval of this variable, which is one of the following: year, quarter, month, week, day, hour, minute, or second. Besides the interval, it also finds the interval unit (E.g. 5 minutes, 10 days, 2 months). Finally, it adds a variable to the data frame that is of a higher interval than the interval of the original datetime variable. The user can then use this variable to aggregate to the higher level, for instance using <code>dplyr</code>’s <code>group_by</code> and <code>summarise</code>. Besides the interval, the user can also specify the units. When no unit is specified, a single unit is applied.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1">to_thicken &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/data.frame">data.frame</a></span>(<span class="dt">day_var =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/as.Date">as.Date</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">'2016-08-12'</span>, <span class="st">'2016-08-13'</span>, </a>
<a class="sourceLine" id="cb8-2" data-line-number="2">                                              <span class="st">'2016-08-26'</span>, <span class="st">'2016-08-29'</span>)))</a>
<a class="sourceLine" id="cb8-3" data-line-number="3">to_thicken <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="../reference/thicken.html">thicken</a></span>(<span class="dt">interval =</span> <span class="st">"week"</span>)</a></code></pre></div>
<pre><code>##      day_var day_var_week
## 1 2016-08-12   2016-08-07
## 2 2016-08-13   2016-08-07
## 3 2016-08-26   2016-08-21
## 4 2016-08-29   2016-08-28</code></pre>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1">to_thicken <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="../reference/thicken.html">thicken</a></span>(<span class="dt">interval =</span> <span class="st">"4 days"</span>)</a></code></pre></div>
<pre><code>##      day_var day_var_4_day
## 1 2016-08-12    2016-08-11
## 2 2016-08-13    2016-08-11
## 3 2016-08-26    2016-08-23
## 4 2016-08-29    2016-08-27</code></pre>
<p>We see different default behavior for the different <em>intervals</em>. Week intervals start on Sundays, day intervals start on the first day found in the datetime variable. In many situations the user will be content with <code>thicken</code>’s defaults. However, you can specify the <code>start_val</code> as an offset if you would like to start the returned interval on a different day or datetime.</p>
<p>We use the emergency data set for further illustration. It contains 120,450 emergency calls in Montgomery County, PA, between 2015-12-10 and 2016-10-17. It has four columns that contain information about the location of the emergency, a title field indicating the type of the emergency, and a time stamp. The data set was created from a Google Api, thanks to Mike Chirico for maintaining this set.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/head">head</a></span>(emergency)</a></code></pre></div>
<pre><code>## # A tibble: 6 x 6
##     lat   lng   zip title                time_stamp          twp           
##   &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt; &lt;chr&gt;                &lt;dttm&gt;              &lt;chr&gt;         
## 1  40.3 -75.6 19525 EMS: BACK PAINS/INJ… 2015-12-10 17:40:00 NEW HANOVER   
## 2  40.3 -75.3 19446 EMS: DIABETIC EMERG… 2015-12-10 17:40:00 HATFIELD TOWN…
## 3  40.1 -75.4 19401 Fire: GAS-ODOR/LEAK  2015-12-10 17:40:00 NORRISTOWN    
## 4  40.1 -75.3 19401 EMS: CARDIAC EMERGE… 2015-12-10 17:40:01 NORRISTOWN    
## 5  40.3 -75.6    NA EMS: DIZZINESS       2015-12-10 17:40:01 LOWER POTTSGR…
## 6  40.3 -75.3 19446 EMS: HEAD INJURY     2015-12-10 17:40:01 LANSDALE</code></pre>
<p>Say we are interested in the number of overdoses that occurred daily. However, we don’t want incidents during the same night to be split into two days, what would have happened when we use the default behavior. Rather, we reset the count at 8 am, grouping all nightly cases to the same day. The interval is still <em>day</em>, but each new day starts at 8 am instead of midnight. The <code>start_val</code> serves as an offset.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1">emergency <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(title <span class="op">==</span><span class="st"> 'EMS: OVERDOSE'</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb14-2" data-line-number="2"><span class="st">  </span><span class="kw"><a href="../reference/thicken.html">thicken</a></span>(<span class="st">'day'</span>, </a>
<a class="sourceLine" id="cb14-3" data-line-number="3">          <span class="dt">start_val =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/as.POSIXlt">as.POSIXct</a></span>(<span class="st">'2015-12-11 08:00:00'</span>, <span class="dt">tz =</span> <span class="st">'EST'</span>),</a>
<a class="sourceLine" id="cb14-4" data-line-number="4">          <span class="dt">colname =</span> <span class="st">'daystart'</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb14-5" data-line-number="5"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span>(daystart) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb14-6" data-line-number="6"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span>(<span class="dt">nr_od =</span> <span class="kw"><a href="https://dplyr.tidyverse.org/reference/n.html">n</a></span>()) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb14-7" data-line-number="7"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/head">head</a></span>()</a></code></pre></div>
<pre><code>## # A tibble: 6 x 2
##   daystart            nr_od
##   &lt;dttm&gt;              &lt;int&gt;
## 1 2015-12-11 08:00:00     1
## 2 2015-12-12 08:00:00     6
## 3 2015-12-13 08:00:00     7
## 4 2015-12-14 08:00:00     8
## 5 2015-12-15 08:00:00     1
## 6 2015-12-16 08:00:00     4</code></pre>
<p>Note also that we specified the column name of the added column. If we don’t, <code>thicken</code> takes the column name of the original datetime variable and appends it with the interval of the thickened variable, separated by an underscore.</p>
<p>Two final points on intervals before we are going to <code>pad</code>:</p>
<ul>
<li>It is about the recurrence pattern, not the moment in time where the observations toke place. (A yearly observation can take place each year at June 23rd at 9.15 pm).</li>
<li>It doesn’t require an observation at each and every time point where there could be one. It is the highest recurrence level in the hierarchy that can explain all the observations.</li>
</ul>
</div>
<div id="pad" class="section level3">
<h3 class="hasAnchor">
<a href="#pad" class="anchor"></a>pad</h3>
<p>The second workhorse of <code>padr</code> is <code>pad</code>. It does date padding:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1">account &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/data.frame">data.frame</a></span>(<span class="dt">day     =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/as.Date">as.Date</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">'2016-10-21'</span>, <span class="st">'2016-10-23'</span>, <span class="st">'2016-10-26'</span>)),</a>
<a class="sourceLine" id="cb16-2" data-line-number="2">                      <span class="dt">balance =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="fl">304.46</span>, <span class="fl">414.76</span>, <span class="fl">378.98</span>))</a>
<a class="sourceLine" id="cb16-3" data-line-number="3">account <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="../reference/pad.html">pad</a></span>()</a></code></pre></div>
<pre><code>## pad applied on the interval: day</code></pre>
<pre><code>##          day balance
## 1 2016-10-21  304.46
## 2 2016-10-22      NA
## 3 2016-10-23  414.76
## 4 2016-10-24      NA
## 5 2016-10-25      NA
## 6 2016-10-26  378.98</code></pre>
<p>The account dataframe has three observations on different days. Like <code>thicken</code>, the <code>pad</code> function figures out what the datetime variable in the data frame is, and then assesses its interval. Next it notices that within the interval, <em>day</em> in this case, rows are lacking between the first and last observation. It inserts a row in the data frame for every time point that is lacking from the data set. All non-datetime values will get missing values at the padded rows.</p>
<p>It is up to the user what to do with the missing records. In the case of the balance of an account we want to carry the last observation forward. It needs <code><a href="https://tidyr.tidyverse.org/reference/fill.html">tidyr::fill</a></code> to arrive at the tidy data set.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" data-line-number="1">account <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="../reference/pad.html">pad</a></span>() <span class="op">%&gt;%</span><span class="st"> </span>tidyr<span class="op">::</span><span class="kw"><a href="https://tidyr.tidyverse.org/reference/fill.html">fill</a></span>(balance)</a></code></pre></div>
<pre><code>## pad applied on the interval: day</code></pre>
<pre><code>##          day balance
## 1 2016-10-21  304.46
## 2 2016-10-22  304.46
## 3 2016-10-23  414.76
## 4 2016-10-24  414.76
## 5 2016-10-25  414.76
## 6 2016-10-26  378.98</code></pre>
<p>Also <code>pad</code> allows for deviations from its default behavior. By default it pads all observations between the first and the last observation, but you can use <code>start_val</code> and <code>end_val</code> to deviate from this. You can also specify a lower interval than the one of the variable, using <code>pad</code> as the inverse of <code>thicken</code>.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" data-line-number="1">account <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="../reference/pad.html">pad</a></span>(<span class="st">'hour'</span>, <span class="dt">start_val =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/as.POSIXlt">as.POSIXct</a></span>(<span class="st">'2016-10-20 22:00:00'</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/head">head</a></span>()</a></code></pre></div>
<pre><code>##                   day balance
## 1 2016-10-20 22:00:00      NA
## 2 2016-10-20 23:00:00      NA
## 3 2016-10-21 00:00:00  304.46
## 4 2016-10-21 01:00:00      NA
## 5 2016-10-21 02:00:00      NA
## 6 2016-10-21 03:00:00      NA</code></pre>
</div>
<div id="grouping" class="section level3">
<h3 class="hasAnchor">
<a href="#grouping" class="anchor"></a>Grouping</h3>
<p>When you want to <code>thicken</code> and <code>pad</code> within groups there are two options. Either you group the data with <code><a href="https://dplyr.tidyverse.org/reference/group_by.html">dplyr::group_by()</a></code> before applying them, or you specify the <code>group</code> argument in <code>pad</code>. Note that <code>thicken</code> does not have a grouping argument, because thickening with or without grouping would give the same result. However, <code>thicken</code> does preserve <code>dplyr</code> grouping.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" data-line-number="1">grouping_df &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/data.frame">data.frame</a></span>(</a>
<a class="sourceLine" id="cb24-2" data-line-number="2">  <span class="dt">group =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rep">rep</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"A"</span>, <span class="st">"B"</span>), <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">3</span>, <span class="dv">3</span>)),</a>
<a class="sourceLine" id="cb24-3" data-line-number="3">  <span class="dt">date  =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/as.Date">as.Date</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"2017-10-02"</span>, <span class="st">"2017-10-04"</span>, <span class="st">"2017-10-06"</span>, <span class="st">"2017-10-01"</span>, </a>
<a class="sourceLine" id="cb24-4" data-line-number="4">                    <span class="st">"2017-10-03"</span>, <span class="st">"2017-10-04"</span>)),</a>
<a class="sourceLine" id="cb24-5" data-line-number="5">  <span class="dt">value =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rep">rep</a></span>(<span class="dv">2</span>, <span class="dv">6</span>)</a>
<a class="sourceLine" id="cb24-6" data-line-number="6">)</a>
<a class="sourceLine" id="cb24-7" data-line-number="7">grouping_df <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb24-8" data-line-number="8"><span class="st">  </span><span class="kw"><a href="../reference/pad.html">pad</a></span>(<span class="dt">group =</span> <span class="st">"group"</span>)</a></code></pre></div>
<pre><code>## pad applied on the interval: day</code></pre>
<pre><code>##   group       date value
## 1     A 2017-10-02     2
## 2     A 2017-10-03    NA
## 3     A 2017-10-04     2
## 4     A 2017-10-05    NA
## 5     A 2017-10-06     2
## 6     B 2017-10-01     2
## 7     B 2017-10-02    NA
## 8     B 2017-10-03     2
## 9     B 2017-10-04     2</code></pre>
<p>Note in the above that each group is padded from its own start to its end. If you want the starts and ends of each groups to be similar use the <code>start_val</code> and <code>end_val</code> arguments. Note further that the interval on which to pad is assessed over the groups. It is assumed that the user wants to bring all observations to the same interval. If you do want each group to have its own interval, use <code><a href="https://dplyr.tidyverse.org/reference/do.html">dplyr::do</a></code> in the following way.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" data-line-number="1">grouping_df <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb27-2" data-line-number="2"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span>(group) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb27-3" data-line-number="3"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/do.html">do</a></span>(<span class="kw"><a href="../reference/pad.html">pad</a></span>(.))</a></code></pre></div>
<pre><code>## pad applied on the interval: 2 day</code></pre>
<pre><code>## pad applied on the interval: day</code></pre>
<pre><code>## Warning: Factor `group` contains implicit NA, consider using
## `forcats::fct_explicit_na`

## Warning: Factor `group` contains implicit NA, consider using
## `forcats::fct_explicit_na`</code></pre>
<pre><code>## # A tibble: 7 x 3
## # Groups:   group [3]
##   group date       value
##   &lt;fct&gt; &lt;date&gt;     &lt;dbl&gt;
## 1 A     2017-10-02     2
## 2 A     2017-10-04     2
## 3 A     2017-10-06     2
## 4 B     2017-10-01     2
## 5 &lt;NA&gt;  2017-10-02    NA
## 6 B     2017-10-03     2
## 7 B     2017-10-04     2</code></pre>
</div>
<div id="fill-functions" class="section level3">
<h3 class="hasAnchor">
<a href="#fill-functions" class="anchor"></a>fill functions</h3>
<p>We already saw <code><a href="https://tidyr.tidyverse.org/reference/fill.html">tidyr::fill</a></code> coming in handy for the filling of missing values after padding. <code>padr</code> comes with three more fill functions: <code>fill_by_value</code>, <code>fill_by_function</code>, and <code>fill_by_prevalent</code>. They fill missing values by respectively a single value, a function of the nonmissing values, and the most prevalent value among the nonmissing values.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb32-1" data-line-number="1">counts &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/data.frame">data.frame</a></span>(<span class="dt">x =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/as.Date">as.Date</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">'2016-11-21'</span>, <span class="st">'2016-11-23'</span>,  <span class="st">'2016-11-24'</span>)),</a>
<a class="sourceLine" id="cb32-2" data-line-number="2">                     <span class="dt">y =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">4</span>)) <span class="op">%&gt;%</span><span class="st"> </span>pad</a></code></pre></div>
<pre><code>## pad applied on the interval: day</code></pre>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb34-1" data-line-number="1">counts <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="../reference/fill_by_value.html">fill_by_value</a></span>()</a></code></pre></div>
<pre><code>##            x y
## 1 2016-11-21 2
## 2 2016-11-22 0
## 3 2016-11-23 4
## 4 2016-11-24 4</code></pre>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb36-1" data-line-number="1">counts <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="../reference/fill_by_value.html">fill_by_value</a></span>(<span class="dt">value =</span> <span class="dv">42</span>)</a></code></pre></div>
<pre><code>##            x  y
## 1 2016-11-21  2
## 2 2016-11-22 42
## 3 2016-11-23  4
## 4 2016-11-24  4</code></pre>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb38-1" data-line-number="1">counts <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="../reference/fill_by_function.html">fill_by_function</a></span>(<span class="dt">fun =</span> mean)</a></code></pre></div>
<pre><code>##            x        y
## 1 2016-11-21 2.000000
## 2 2016-11-22 3.333333
## 3 2016-11-23 4.000000
## 4 2016-11-24 4.000000</code></pre>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb40-1" data-line-number="1">counts <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="../reference/fill_by_prevalent.html">fill_by_prevalent</a></span>()</a></code></pre></div>
<pre><code>##            x y
## 1 2016-11-21 2
## 2 2016-11-22 4
## 3 2016-11-23 4
## 4 2016-11-24 4</code></pre>
<p>Note that in the first <code>fill_by_value</code> the columns to fill are not specified. In this case the filling is applied on all the columns. The other two functions also have this default behavior.</p>
</div>
<div id="formatting-functions" class="section level2">
<h2 class="hasAnchor">
<a href="#formatting-functions" class="anchor"></a>Formatting functions</h2>
<p>After aggregating the data to a higher interval, all the observations in an interval are represented by a single point in time. This is either the first (rounding down) or the last (rounding up) datetime point of the interval. Two functions are offered to reformat the datetime variable, so the data might be better represented a table or a graph. First of all, <code>center_interval</code> will move the time point to the center of the interval. This would give a better representation in point, line and bar graphs.</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb42-1" data-line-number="1">emergency <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb42-2" data-line-number="2"><span class="st">  </span><span class="kw"><a href="../reference/thicken.html">thicken</a></span>(<span class="st">"hour"</span>, <span class="st">"h"</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb42-3" data-line-number="3"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/tally.html">count</a></span>(h) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb42-4" data-line-number="4"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice</a></span>(<span class="dv">1</span><span class="op">:</span><span class="dv">24</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb42-5" data-line-number="5"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="dt">h_center =</span> <span class="kw"><a href="../reference/center_interval.html">center_interval</a></span>(h)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb42-6" data-line-number="6"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(h_center, n)) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span>(<span class="dt">stat =</span> <span class="st">"identity"</span>)</a></code></pre></div>
<p><img src="padr_files/figure-html/unnamed-chunk-13-1.png" width="672"></p>
<p>The bars are now between the hours, rather than on the hours. More true to the nature of the interval.</p>
<p>Next, there is <code>format_interval</code>. This creates a categorical variable that describes the start and end of the interval. This works great with asymmetric data, as shown in the dedicated vignette, but can also be informative with regular intervals. You can specify the way you want the start and the end to be formatted just like you would in <code>strftime</code>.</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb43-1" data-line-number="1">emergency <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb43-2" data-line-number="2"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(title <span class="op">==</span><span class="st"> "EMS: HEAD INJURY"</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb43-3" data-line-number="3"><span class="st">  </span><span class="kw"><a href="../reference/thicken.html">thicken</a></span>(<span class="st">"6 hour"</span>, <span class="st">"hour6"</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb43-4" data-line-number="4"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/tally.html">count</a></span>(hour6) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb43-5" data-line-number="5"><span class="st">  </span><span class="kw"><a href="../reference/pad.html">pad</a></span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb43-6" data-line-number="6"><span class="st">  </span><span class="kw"><a href="../reference/fill_by_value.html">fill_by_value</a></span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb43-7" data-line-number="7"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="dt">hour6_fmt =</span> </a>
<a class="sourceLine" id="cb43-8" data-line-number="8">           <span class="kw"><a href="../reference/format_interval.html">format_interval</a></span>(hour6, <span class="dt">start_format =</span> <span class="st">"%Hh"</span>, <span class="dt">sep =</span> <span class="st">"-"</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb43-9" data-line-number="9"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(hour6_fmt, n)) <span class="op">+</span></a>
<a class="sourceLine" id="cb43-10" data-line-number="10"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span>()</a></code></pre></div>
<p><img src="padr_files/figure-html/unnamed-chunk-14-1.png" width="700"></p>
</div>
<div id="further-details" class="section level2">
<h2 class="hasAnchor">
<a href="#further-details" class="anchor"></a>Further details</h2>
<p>There are two more vignettes. In <code>padr_implementation</code> you can find more information about how <code>padr</code> handles daylight savings time, what it does with different time zones and how <code>thicken</code> exactly is implemented. <code>padr_custom</code> shows you how you can thicken and pad with asymmetric intervals.</p>
</div>
<div id="suggestions" class="section level2">
<h2 class="hasAnchor">
<a href="#suggestions" class="anchor"></a>Suggestions?</h2>
<p>Found a bug? Ideas for improving or expanding <code>padr</code>. Your input is much appreciated. The code is maintained at <a href="https://github.com/EdwinTh/padr" class="uri">https://github.com/EdwinTh/padr</a> and you are most welcome to file an issue or do a pull request.</p>
</div>
<div class="footnotes">
<hr>
<ol>
<li id="fn1"><p>Many users who work with date and time variables will be using the <code>lubridate</code> package. The definition of an interval in <code>lubridate</code> is different from the definition in <code>padr</code>. In <code>lubridate</code> an interval is a period between two time points and has nothing to do with recurrence. Please keep this in mind.<a href="#fnref1" class="footnote-back">↩</a></p></li>
</ol>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#formatting-functions">Formatting functions</a></li>
      <li><a href="#further-details">Further details</a></li>
      <li><a href="#suggestions">Suggestions?</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Edwin Thoen.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
